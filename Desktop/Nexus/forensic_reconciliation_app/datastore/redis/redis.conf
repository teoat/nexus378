# Forensic Reconciliation + Fraud Platform - Redis Configuration
# Redis 7+ Configuration File

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================

# Bind to all interfaces for Docker
bind 0.0.0.0

# Port configuration
port 6379

# TCP keepalive
tcp-keepalive 300

# =============================================================================
# GENERAL CONFIGURATION
# =============================================================================

# Daemonize (set to no for Docker)
daemonize no

# PID file
pidfile /var/run/redis_6379.pid

# Log level
loglevel notice

# Log file
logfile ""

# Database count
databases 16

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Require password
requirepass ${REDIS_PASSWORD:-forensic_secure_2024}

# Protected mode
protected-mode yes

# =============================================================================
# MEMORY CONFIGURATION
# =============================================================================

# Maximum memory usage
maxmemory 2gb

# Memory policy
maxmemory-policy allkeys-lru

# Memory samples for LRU
maxmemory-samples 5

# =============================================================================
# PERSISTENCE CONFIGURATION
# =============================================================================

# Enable AOF persistence
appendonly yes

# AOF filename
appendfilename "appendonly.aof"

# AOF sync policy
appendfsync everysec

# AOF rewrite percentage
auto-aof-rewrite-percentage 100

# AOF rewrite minimum size
auto-aof-rewrite-min-size 64mb

# RDB persistence
save 900 1
save 300 10
save 60 10000

# RDB compression
rdbcompression yes

# RDB filename
dbfilename dump.rdb

# =============================================================================
# REPLICATION CONFIGURATION
# =============================================================================

# Replica read-only
replica-read-only yes

# Replica priority
replica-priority 100

# =============================================================================
# CLIENT CONFIGURATION
# =============================================================================

# Max clients
maxclients 10000

# Client timeout
timeout 0

# Client keepalive
tcp-keepalive 300

# =============================================================================
# SLOW LOG CONFIGURATION
# =============================================================================

# Slow log threshold
slowlog-log-slower-than 10000

# Slow log length
slowlog-max-len 128

# =============================================================================
# LATENCY MONITORING
# =============================================================================

# Latency monitor threshold
latency-monitor-threshold 100

# =============================================================================
# EVENT NOTIFICATION
# =============================================================================

# Notify keyspace events
notify-keyspace-events ""

# =============================================================================
# ADVANCED CONFIGURATION
# =============================================================================

# Hash max ziplist entries
hash-max-ziplist-entries 512

# Hash max ziplist value
hash-max-ziplist-value 64

# List max ziplist entries
list-max-ziplist-entries 512

# List max ziplist value
list-max-ziplist-value 64

# Set max intset entries
set-max-intset-entries 512

# Zset max ziplist entries
zset-max-ziplist-entries 128

# Zset max ziplist value
zset-max-ziplist-value 64

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# TCP backlog
tcp-backlog 511

# Unix socket
unixsocket /tmp/redis.sock
unixsocketperm 700

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Syslog enabled
syslog-enabled no

# Syslog ident
syslog-ident redis

# Syslog facility
syslog-facility local0

# =============================================================================
# CLUSTER CONFIGURATION
# =============================================================================

# Cluster enabled
cluster-enabled no

# Cluster config file
cluster-config-file nodes.conf

# Cluster node timeout
cluster-node-timeout 15000

# =============================================================================
# SLOW QUERY LOG
# =============================================================================

# Slow query log enabled
slowlog-log-slower-than 10000

# Slow query log max length
slowlog-max-len 128

# =============================================================================
# LATENCY MONITOR
# =============================================================================

# Latency monitor threshold
latency-monitor-threshold 100

# =============================================================================
# EVICTION POLICY
# =============================================================================

# Max memory policy
maxmemory-policy allkeys-lru

# Max memory samples
maxmemory-samples 5

# =============================================================================
# LAZY FREEING
# =============================================================================

# Lazy free on eviction
lazyfree-lazy-eviction no

# Lazy free on expire
lazyfree-lazy-expire no

# Lazy free on del
lazyfree-lazy-del no

# Lazy free on unlink
lazyfree-lazy-unlink no

# =============================================================================
# THREADED I/O
# =============================================================================

# I/O threads enabled
io-threads 4

# I/O threads read only
io-threads-do-reads no

# =============================================================================
# MODULE CONFIGURATION
# =============================================================================

# Load modules
# loadmodule /path/to/module.so

# =============================================================================
# CUSTOM CONFIGURATION
# =============================================================================

# Forensic platform specific settings
# Cache TTL for evidence metadata
set cache:evidence:ttl 3600

# Cache TTL for user sessions
set cache:session:ttl 86400

# Cache TTL for case data
set cache:case:ttl 1800

# Cache TTL for risk scores
set cache:risk:ttl 300

# Queue configuration for AI agents
set queue:ai:agents:max 10
set queue:ai:jobs:max 100
set queue:ai:priority:levels 5
